<!DOCTYPE html>
<html xmlns:layout="http://www.w3.org/1999/xhtml" layout:decorate="~{layouts/layout}">
<head>

	<title>LAB SETUP</title>
	
	<style type="text/css">
	
	#labDetailsTable a {
		text-decoration: none;
	}
	
	</style>

</head>

<body>
	<main role="main" class="container-fluid" layout:fragment="content">
		<form id="labSetupForm" novalidate>
		
			<div class="row mt-3">
				<div class="col-12 text-center">
					<h6 class="font-weight-bold mt-1">LAB SETUP</h6>
				</div>
			</div>
	
			<div class="row justify-content-between">
				<div class="col-6">
					<div class="input-group input-group-sm w-50">
						<input type="text" class="form-control"
							placeholder="Institution Name"
							aria-describedby="MaterialButton-addon2">
						<div class="input-group-append">
							<button id="MaterialButton-addon2"
								class="btn btn-primary pageable searchelement" type="button">
								<i class="fa fa-search"></i>
							</button>
						</div>
					</div>
				</div>

				<div class="col-4 text-right">
					<a th:href="@{/setup/gotoNewLabEntry}"> 
						<button type="button" class="btn btn-warning btn-sm">
							<i class="fa fa-plus "></i> Add
						</button>
					</a>
					
					<!-- <button type="button" class="btn btn-warning btn-sm"
						data-toggle="modal" data-target="#staticBackdrop">
						<i class="fa fa-plus "></i> Add
					</button> -->
				</div>
			</div>
	
			<div class="row my-2">
				<div class="col-12">
					<table class="table table-sm table-bordered vertical-middle" id="labDetailsTable">
						<tr class="thead-light">
							<th width="3%" class="text-center p-2">#</th>
							<th class="p-2">NAME</th>
							<th width="42%" class="p-2">ADDRESS</th>
							<th width="15%" class="p-2">LAB DISTRICT</th>
							<th width="5%" class="p-2"></th>
						</tr>
						<tr th:if="labDetails==null OR ${#lists.isEmpty(labDetails)}">
							<td colspan="10" class="text-center">-- No Details Found --</td>
						</tr>
						<tr th:if="${not #lists.isEmpty(labDetails)}"
							th:each="detail, status : ${labDetails}" th:id="${detail.id}"
							class="detailsRow">
							<td class="text-center serialNo p-2" th:text="${status.count+((pagination.pageNumber-1)*pagination.pageSize)}"></td>
							
							<td class="text-uppercase font-weight-bold cursor-pointer p-2">
								<a th:href="@{/setup/gotoLabEntryDetails/{id}(id=${detail.id})}" title="Click to edit details"> 
									<span th:text="${detail.name}" class="text-primary" th:if="${detail.activeStatus=='Y'}"></span>
									<span th:text="${detail.name}" class="text-danger" th:unless="${detail.activeStatus=='Y'}"></span>
								</a>
							</td>
							
							<td class="p-2">
								<span th:text="${detail.address}"></span>
							</td>
							
							<td class="p-2">
								<span th:if="${detail.district!=null}" th:text="${detail.district.districtName}"></span>
								<span th:unless="${detail.district!=null}">--</span>
							</td>
							
							<td class="text-center p-2 cursor-pointer" th:switch="${detail.activeStatus}">
								<span th:case="'Y'" class="btn btn-danger btn-sm" th:attr="onclick=|updateactivatestatus('${detail.id}','D')|">Deactivate</span>
								<span th:case="'N'" class="btn btn-success btn-sm px-3" th:attr="onclick=|updateactivatestatus('${detail.id}','A')|">Activate</span>
							</td>
						</tr>
					</table>
				</div>
			</div>
	
			<div class="row mb-5"
				th:if="${not #lists.isEmpty(details)}"
				th:replace="fragments/pagination :: pagination">
				<!-- PAGINATION -->
			</div>

		</form>
	</main>
</body>

</html>

<script th:inline="javascript">
	
	function updateactivatestatus(id, status) {
		var warning = "";
		if (status == "D") {
			warning = "Do you want to Deactivate the Lab ?";
		} else {
			warning = "Do you want to Activate the Lab ?";
		}
		if (confirm(warning)) {
			$.ajax({
				type : "GET",
				url : "../setup/updateactivatestatus",
				data : {
					id : id,
					status : status
				},
				success : function(msg) {
					window.location.reload()
				}
			});
		}
	}
	
</script>